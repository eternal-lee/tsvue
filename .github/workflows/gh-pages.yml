name: Build and Deploy
on: # ç›‘å¬ main åˆ†æ”¯ä¸Šçš„ push äº‹ä»¶
  push:
    branches:
      - master
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # æ„å»ºç¯å¢ƒä½¿ç”¨ ubuntu
    steps: # æ­¥éª¤
      # ç¬¬ä¸€æ­¥ï¼šä¸‹è½½æºç ï¼ˆCI/CDæ‹‰å–ä»£ç åˆ°è‡ªå·±çš„æœ¬åœ°ï¼‰
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v2.3.1

      # ç¬¬äºŒæ­¥ï¼šæ‰“åŒ…æ„å»º
      - name: Install and Build # ä¸‹è½½ä¾èµ– æ‰“åŒ…é¡¹ç›®
        run: |
          npm install --legacy-peer-deps
          npm run build
      # - run: tar -zcvf release.tgz .nuxt static nuxt.config.js package.json package-lock.json pm2.config.json
      # æŠŠ.nuxtã€nuxt.config.jsç­‰æ–‡ä»¶ï¼Œæ‰“åŒ…å‹ç¼©ä¸ºrelease.tgz

      # BRANCH: éƒ¨ç½²åˆ°æäº¤åˆ°é‚£ä¸ªåˆ†æ”¯
      - name: Deploy ğŸš€ # å°†æ‰“åŒ…å†…å®¹å‘å¸ƒåˆ° github page
        uses: JamesIves/github-pages-deploy-action@4.1.1
        # uses: crazy-max/ghaction-github-pages@v2
        with: # è‡ªå®šä¹‰ç¯å¢ƒå˜é‡
          # éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯
          branch: gh-pages # The branch the action should deploy to.
          folder: dist # The folder the action should deploy.
